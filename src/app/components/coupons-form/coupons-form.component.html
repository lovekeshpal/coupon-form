


<div class="container mt-5 mb-5 w-50">
  <form [formGroup]="couponsForm" (ngSubmit)="submit()">
  <div class="row justify-content-center">
    <mat-form-field appearance="outline">
      <mat-label>Coupon Code</mat-label>
      <input matInput formControlName="couponCode">
      <mat-error>Coupon Code is Required</mat-error>
    </mat-form-field>
  </div>
  <div class="row justify-content-center">
    <mat-form-field appearance="outline">

        <mat-label>Coupon Type</mat-label>
        <mat-select formControlName="couponType">
          <mat-option value="user">User</mat-option>
          <mat-option value="other">Other</mat-option>
        </mat-select>
     </mat-form-field>
  </div>
    <div class="row justify-content-center">
      <mat-form-field appearance="outline">
        <mat-label>Enter a date range</mat-label>
        <mat-date-range-input  [rangePicker]="picker">
          <input matStartDate placeholder="Start date" formControlName = "validFrom" required>
          <input matEndDate placeholder="End date" formControlName = "validTo" required>

        </mat-date-range-input>
        <mat-hint>MM/DD/YYYY â€“ MM/DD/YYYY</mat-hint>
        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
        <mat-date-range-picker #picker></mat-date-range-picker>
        <mat-error>Date range is Required</mat-error>
      </mat-form-field>
    </div>


  <div class="row">
    <mat-form-field appearance="outline">

      <mat-label>Coupon Status</mat-label>
      <mat-select formControlName = "couponStatus">
        <mat-option value="user">Active</mat-option>
        <mat-option value="other">Inactive</mat-option>
      </mat-select>
    </mat-form-field>
  </div>
  <div class="row">

    <div class="col-md-8">
  <mat-form-field class="w-100" appearance="outline">
    <mat-label>Coupon Count</mat-label>
    <input formControlName = "couponCount" matInput required>
    <mat-error>Coupon Code is Required</mat-error>
  </mat-form-field>
    </div>
    <div class="col-md-4">
      <mat-form-field class="w-100" appearance="outline">

        <mat-label>Coupon Availability</mat-label>
        <mat-select formControlName = "couponAvailability" (ngModelChange)="availability()">
          <mat-option value="limited">Limited</mat-option>
          <mat-option value="unlimited">Unlimited</mat-option>
        </mat-select>
      </mat-form-field>
    </div>
</div>
  <div class="row">
    <angular-editor [config] = "config" formControlName = "tnc"></angular-editor>

  </div>
  <div class="row mt-4">
    <h2>Coupon Rules</h2>
    <mat-divider></mat-divider>
  </div>



  <div class="row">
    <div formArrayName = "rulesGrid">
    <mat-card class="mt-2 p-2" *ngFor="let ruleGrid of rulesGridControls; let i=index;" formGroupName = {{i}}>
      <mat-card-header>
        <mat-card-title>Rule {{i+1}}</mat-card-title>

      </mat-card-header>

      <div class="row mt-2">
        <div class="col-md-6">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Min Amount</mat-label>
            <input formControlName = "min_amount" matInput>
            <mat-error>Minimum Amount is required and should be in numbers</mat-error>
          </mat-form-field>
        </div>
        <div class="col-md-6">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Max Amount</mat-label>
            <input matInput formControlName = "max_amount">

          </mat-form-field>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-md-6">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Discount Type</mat-label>
            <mat-select formControlName = "discount_type">
              <mat-option value="user">Percentage</mat-option>
              <mat-option value="other">Amount</mat-option>
            </mat-select>
            <mat-error>Please select discount type</mat-error>
          </mat-form-field>
        </div>
        <div class="col-md-6">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Discount</mat-label>
            <input matInput formControlName = "discount">
            <mat-error>Please provide Discount value</mat-error>
          </mat-form-field>
        </div>
      </div>
      <div class="row mt-2">
        <div class="col-md-6">
          <mat-form-field class="w-100" appearance="outline">
            <mat-label>Max Discount Amount</mat-label>
            <input matInput formControlName = "max_discount">

          </mat-form-field>
        </div>
        <div class="col-md-6">

        </div>
      </div>

    </mat-card>
    </div>

  </div>
  <div class="row m-2">
    <div class="col-md-8"></div>
    <div class="col-md-4">
      <div class="row g-0">
        <div class="col-6 d-flex flex-row-reverse">
          <i class="bi bi-plus-circle-fill fa-2x"></i>
        </div>
        <div class="col-6 d-flex flex-row-reverse">
          <span class="add-more mt-2" (click)="addRule()">Add More</span>
        </div>
      </div>
    </div>

  </div>
    <button type="submit" [disabled]="couponsForm.invalid" mat-raised-button color="primary">Save</button>
</form>
</div>






